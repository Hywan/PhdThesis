\section{Génération d'objets}
\label{section:data:objects}

Les sections précédentes expliquaient comment générer des données scalaires,
telles que des booléens, des entiers, réels ou chaînes, et aussi des données
plus complexes, telles que des tableaux. Nous allons décrire comment générer des
objets, puisque le paradigme le plus utilisé en PHP5\footnote{Sortie en juillet
2004.} est l'objet. \\

Un objet est une aggrégation d'attributs et de méthodes. Les deux sont annotés
par des contrats Praspel, respectivement par la clause \ainvariant et les autres
clauses (voir les entités syntaxiques \grule{attribute-clauses} et
\grule{method-clauses} de la Figure~\ref{figure:language:grammar_part0} et la
Figure~\ref{figure:language:typical_contract} pour les positionner). Alors, la
stratégie pour générer un objet est de l'instancier en appelant son
constructeur, et de définir une valeur à ses attributs. Les valeurs des
arguments du constructeur sont générées grâce à sa précondition. Les valeurs des
attributs sont générées grâce aux invariants. Si un argument du constructeur ou
un attribut est lui-même un objet, ce processus est répété récursivement. Nous
contournons l'encapsulation pour accéder aux attributs protégés et privés ou aux
méthodes en instrumentant le code source.

Afin de gérer les références circulaires (par exemple quand un premier objet a
un attribut qui pointe sur un deuxième objet, qui a lui-même un attribut qui
pointe vers le premier objet), nous appliquons une stratégie inspirée de
Jartege~\acite{Oriat05} et UDITA~\acite{GligoricGJKKM10}. Cette stratégie
consiste à enregistrer les objets créés dans un groupe. Quand un objet est
demandé, nous avons le choix entre en générer un nouveau ou en choisir un dans
le groupe. Ce choix est dynamiquement réalisé en fonction de l'état du groupe~:
plus il contient d'objets, moins il y aura de nouveaux objets générés. Ce choix
est paramétrable par une fonction de répartition fournie par l'utilisateur.
